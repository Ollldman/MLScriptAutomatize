# Документация по работе модулей загрузки данных из различных источников.

## 1. load_from_static.py:
Модуль отвечает за реализацию получения pandas.DataFrame из статических файлов, сохраненных у пользователя на локальной машине, полученных как открытый поток, или получаемых асинхронно по API запросам.

Необходимо подготовить путь `filepath` до нужного файла в формате строки или иной удобный и доступный для pandas.read*** тип источника. (см. документацию pandas)

Представлены функции:
- `load_from_csv` для загрузки файлов из `*.csv`

и 

- `load_from_excel`, для загрузки файлов-excel таблиц.

Данные функции являются дублями функциональности от pandas.read***.

Для тестирования функций в этом модуле, путь к файлам таблиц берется из глобального конфигурационного файла `.env`

## 2. async_load_from_db.py
Модуль отвечает за реализацию получения pandas.DataFrame из реляционных баз данных с использованием SQL-запросов, сервер которых реализован у пользователя на локальной машине.

В данный момент доступна функциональность только для PostgreSQL.

- `class AsyncSQLRunner()`

В модуле представлена реализация объекта SQLRunner отвечающего за асинхронное взаимодействие с базой данных пользователя PostgreSQL по передаваемой строке соединения. (Для тестирования работы методов, используется строка подключения из .env файла проекта, указанная в settings.py).

- `def async_sql_to_df(...)`

Дополнительно, для упрощения работы, представлена функция async_sql_to_df(...) которая возвращает pandas.DataFrame по переданной строке SQL-запроса, строке соединения и дополнительных необходимых параметрах, которые используются в библиотечном методе pandas.read_sql_query(...).

Реализация тесно связана с ограничением на выполнение только SELECT -запросов к базе данных с целью получения релевантных табличных данных и с целью обеспечения безопасности базы данных от инъекций и ошибочных запросов.

Необходимая функциональность в будущем:
- Валидация имён таблиц/столбцов из allowlist,
- Ограничение по времени выполнения запроса,
- Ограничение по объёму возвращаемых данных,
- Аудит логов: кто, когда, какой SELECT выполнил,
- Интеграция с Pydantic для валидации структуры результата.
     

